<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Adam Narozniak, Alessandro Tavazzi, Nicolas dâ€™Argenlieu">
        <title>worldwide reactions</title>

        <!-- Load d3.js -->
        <script src="https://d3js.org/d3.v6.js"></script>
        <script type="text/javascript" src="./../lib/world_reactions_utils.js"></script>
    </head>
<body>
<h1> Wordwide reactions </h1>
<div id="refugees_data"></div>

<iframe title="Sanctions on Russia by Date &amp;amp; Country" aria-label="Stacked Column Chart" id="datawrapper-chart-2XXNx" src="https://datawrapper.dwcdn.net/2XXNx/13/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="550"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(e){if(void 0!==e.data["datawrapper-height"]){var t=document.querySelectorAll("iframe");for(var a in e.data["datawrapper-height"])for(var r=0;r<t.length;r++){if(t[r].contentWindow===e.source)t[r].style.height=e.data["datawrapper-height"][a]+"px"}}}))}();</script>

<script>
    class RefugeesLoader {
        refugees;

        constructor(path) {
            this.path = path;
        }

        async load_data() {
            this.refugees = await d3.dsv(";", this.path);
            // return this.refugees
            const parseTime = d3.timeParse("%d/%m/%Y");
            return this.refugees.map(csv => [parseTime(csv['data_date']), parseFloat(csv['individuals'])])
        }
    }

    let path = './../../data/NDA_UNHCR_refugees_cleaned.csv';
    let loader = new RefugeesLoader(path);
    let promise = loader.load_data().then((data) => {

            chart = BarChart(data, {
                x: d => d[0],
                y: d => d[1],
                xDomain: d3.map(data, d => d[0]), // sort by descending frequency
                xType:d3.scaleTime,
                yFormat: "d",
                yLabel: "Date",
                width:500,
                height: 500,
                color: "steelblue",
                title: d => d[1]
            });

            const margin = {top: 10, right: 30, bottom: 30, left: 60},
                width = 900 - margin.left - margin.right,
                height = 500 - margin.top - margin.bottom;

            d3.select("#refugees_data")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .html(chart.innerHTML)

        }
    );
    
</script>
</body>
</html>